
function []=spo2ida_plotIDA(idac,cap,a,ac,mc,r,plotflag,linew,fontsize,...
			    xlab,ylab);

% []=spo2ida_plotIDA(idac,cap,a,ac,mc,r,plotflag);
%_______________________________________________________
%
%_______________________________________________________
% maybe you should make this a seperate function!
% it should be the same across all versions of my spo2ida routines!

% Last updated Jan 29th, 2002
% can plot anywhere from 1 to 3 idas!
% Now, if any of the  a,ac,mc,r is NaN, then the pXXmXXcXX label is 
% not printed. Also, the axes-labels can be customized.

%plotstyles={'b--','r-','g-.'};
plotstyles={'g--','r-','m-.'};

if nargin<11
  ylab='strength reduction factor, R = S_a / S_a^{yield}';
end  
if nargin<10
  xlab='ductility, \mu = \delta / \delta ^{yield}';
end
if nargin<9, fontsize=11; end
if nargin<8, linew=2; end

for i=1:3
  if plotflag(i)
    figure(plotflag(i))
    set(gca,'box','on','fontsize',fontsize)
    hold on   
    plot(idac(i).m,idac(i).r,plotstyles{i},'linew',linew);
    h=plot(cap(i).m,cap(i).r,'bo');
    set(h,'markerfacecolor',[0,1,0])
    set(h,'markersize',10)
    if all(~isnan([a,ac,mc,r]))
      text(idac(i).m(end),idac(i).r(end),sprintf(...
	  ' \\bf p%dm%dc%dr%d',a*100,abs(ac)*100,mc*10,r*100))
    end
    grid on
    xlabel(xlab);
    ylabel(ylab);
  end
end  


