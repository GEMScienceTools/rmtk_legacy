# -*- coding: utf-8 -*-
"""
Created on Thu Sep 25 16:17:34 2014

@author: chiaracasotto
"""
import os
import matplotlib.pyplot as plt
from common.print_csv import print_outputs

def export_vulnerability(vuln, plot_feature, x, y):
    plotflag, linew, fontsize, units, iml = plot_feature[0:5]
    cd = os.getcwd()
    if plotflag[3]:
        plot_vulnerability(iml, x, fontsize, units)
    # Export discrete vulnerability curve to csv
    output_path = cd+'/outputs/vulnerability_curve.csv'
    header = ['Intensity Measure Level','mean Loss Ratio','coefficient of variation Loss Ratio']
    n_lines = len(x)
    col_data = [iml, x, y/x] # mean and coefficient of variation of LR
    print_outputs(output_path,header,n_lines,col_data)

def plot_vulnerability(iml, x, fontsize, units):
    cd = os.getcwd()    
    plt.plot(iml,x, marker='o', linestyle='None',label = 'LR')
    plt.xlabel('Spectral acceleration at T elastic, Sa(Tel) [g]',fontsize = fontsize)
    plt.ylabel('Loss Ratio',fontsize = fontsize)
    plt.suptitle('Vulnerability Curve',fontsize = fontsize)
    plt.legend(loc='lower right',frameon = False)
    plt.savefig(cd+'/outputs/vulnerability_curve.png')
    plt.show()